<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Unity Game Submissions Admin</title>

  <!-- Tailwind Config with Dark Mode enabled -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {}
      }
    }
  </script>

  <!-- Load Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="elm-admin-app"></div>

  <!-- Compiled Elm application -->
  <script src="admin.js"></script>

  <!-- Import Firebase integration -->
  <script type="module">
    import { initializeFirebase } from './firebase-admin.js';

    document.addEventListener('DOMContentLoaded', function() {
      // Check for saved theme preference or use system preference
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark' || 
          (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark');
      }
      
      // Initialize the Elm application
      const elmApp = Elm.Admin.init({
        node: document.getElementById('elm-admin-app')
      });

      // Initialize Firebase with the Elm app
      initializeFirebase(elmApp);
      
      // Set up theme toggle port
      if (elmApp.ports && elmApp.ports.storeTheme) {
          elmApp.ports.storeTheme.subscribe(function(theme) {
              localStorage.setItem('theme', theme);
              
              if (theme === 'dark') {
                  document.documentElement.classList.add('dark');
              } else {
                  document.documentElement.classList.remove('dark');
              }

              console.log('Theme set to:', theme);
          });
      }

      // Load saved theme port
      if (elmApp.ports && elmApp.ports.loadSavedTheme) {
          elmApp.ports.loadSavedTheme.subscribe(function() {
              const currentTheme = localStorage.getItem('theme') ||
                  (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');

              if (elmApp.ports.receiveTheme) {
                  elmApp.ports.receiveTheme.send(currentTheme);
              }

              console.log('Loaded saved theme:', currentTheme);
          });
      }
    });
  </script>
</body>
</html>
